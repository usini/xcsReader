// Translations for XCS Reader
const translations = {
    fr: {
        // Header
        appTitle: "üîß XCS Reader",
        appSubtitle: "Lecteur de fichiers xTool Creative Space",
        
        // Upload
        dropzoneText: "Glissez-d√©posez un fichier <strong>.xcs</strong> ici",
        dropzoneOr: "ou",
        browseFiles: "Parcourir les fichiers",
        invalidFile: "Veuillez s√©lectionner un fichier .xcs",
        readError: "Erreur lors de la lecture du fichier: ",
        
        // Tabs
        tabGeneral: "G√©n√©ral",
        tabDevice: "Appareil",
        tabCover: "Aper√ßu",
        tabCanvas: "Canvas",
        tabLayers: "Calques",
        tabProcess: "Traitement",
        tabElements: "√âl√©ments",
        tabDistances: "Distances",
        tabJson: "JSON",
        
        // Section titles
        titleGeneral: "üìã Informations g√©n√©rales",
        titleDevice: "üñ®Ô∏è Appareil",
        titleCover: "üñºÔ∏è Aper√ßu du projet",
        titleCanvas: "üé® Canvas",
        titleLayers: "üìö Calques (Layers)",
        titleProcess: "‚öôÔ∏è Param√®tres de traitement",
        titleElements: "üî≤ √âl√©ments graphiques",
        titleDistances: "üìè Distances entre √©l√©ments",
        titleJson: "üìÑ Donn√©es JSON brutes",
        
        // General info labels
        version: "Version",
        createdAt: "Cr√©√© le",
        modifiedAt: "Modifi√© le",
        canvasId: "ID Canvas",
        projectId: "ID Projet",
        elementsCount: "Nombre d'√©l√©ments",
        layersCount: "Nombre de calques",
        
        // Device
        deviceType: "Type d'appareil",
        laserPower: "Puissance laser",
        accessories: "Accessoires",
        
        // Canvas
        canvasWidth: "Largeur",
        canvasHeight: "Hauteur",
        gridVisible: "Grille visible",
        rulerVisible: "R√®gle visible",
        
        // Layers
        layerVisible: "Visible",
        layerHidden: "Masqu√©",
        layerLocked: "Verrouill√©",
        layerUnlocked: "D√©verrouill√©",
        
        // Elements
        elementSize: "Taille",
        elementPosition: "Position",
        elementRotation: "Rotation",
        elementVisible: "Visible",
        elementHidden: "Masqu√©",
        closedPath: "Chemin ferm√©",
        openPath: "Chemin ouvert",
        filled: "Rempli",
        notFilled: "Non rempli",
        strokeWidth: "Trait",
        noPreview: "Pas d'aper√ßu",
        
        // Process
        processParams: "Param√®tres de traitement",
        globalParams: "Param√®tres globaux",
        elementParams: "Param√®tres par √©l√©ment",
        power: "Puissance",
        speed: "Vitesse",
        passes: "Passes",
        dpi: "DPI",
        density: "Densit√©",
        frequency: "Fr√©quence",
        laserSource: "Laser",
        slices: "Slices",
        angle: "Angle",
        ignored: "Ignor√©",
        viewElement: "Voir √©l√©ment",
        viewDetails: "D√©tails",
        defaultParams: "Param√®tres par d√©faut",
        noProcessAssociated: "Aucun traitement associ√©",
        
        // Process types
        processRelief: "üèîÔ∏è Relief 3D",
        processBitmapEngraving: "üñºÔ∏è Gravure Bitmap",
        processVectorEngraving: "‚úèÔ∏è Gravure Vecteur",
        processVectorCutting: "‚úÇÔ∏è D√©coupe",
        processScore: "üìè Score",
        
        // Distances
        distancesInfo: "Distances calcul√©es entre les centres des √©l√©ments (en mm)",
        filterSameLayer: "Afficher uniquement les √©l√©ments du m√™me calque",
        sortBy: "Trier par:",
        sortDistanceAsc: "Distance (croissant)",
        sortDistanceDesc: "Distance (d√©croissant)",
        sortName: "Nom",
        element1: "√âl√©ment 1",
        element2: "√âl√©ment 2",
        distance: "Distance",
        noPairFound: "Aucune paire trouv√©e",
        totalPairs: "Total:",
        pairs: "paires d'√©l√©ments",
        needTwoElements: "Il faut au moins 2 √©l√©ments pour calculer les distances",
        
        // JSON
        copyJson: "üìã Copier le JSON",
        downloadJson: "üíæ T√©l√©charger",
        jsonCopied: "JSON copi√© dans le presse-papier !",
        
        // General
        noData: "Aucune donn√©e disponible",
        noPreviewAvailable: "Aucun aper√ßu disponible",
        noElementAvailable: "Aucun √©l√©ment disponible",
        noCanvasAvailable: "Aucun canvas disponible",
        noLayerAvailable: "Aucun calque disponible",
        noProcessAvailable: "Aucun param√®tre de traitement disponible",
        unrecognizedFormat: "Format de donn√©es non reconnu",
        
        // Footer
        footer: "XCS Reader - Lecteur de fichiers xTool Creative Space (.xcs)",
        
        // Language
        language: "Langue"
    },
    
    en: {
        // Header
        appTitle: "üîß XCS Reader",
        appSubtitle: "xTool Creative Space File Reader",
        
        // Upload
        dropzoneText: "Drag and drop a <strong>.xcs</strong> file here",
        dropzoneOr: "or",
        browseFiles: "Browse files",
        invalidFile: "Please select a .xcs file",
        readError: "Error reading file: ",
        
        // Tabs
        tabGeneral: "General",
        tabDevice: "Device",
        tabCover: "Preview",
        tabCanvas: "Canvas",
        tabLayers: "Layers",
        tabProcess: "Processing",
        tabElements: "Elements",
        tabDistances: "Distances",
        tabJson: "JSON",
        
        // Section titles
        titleGeneral: "üìã General Information",
        titleDevice: "üñ®Ô∏è Device",
        titleCover: "üñºÔ∏è Project Preview",
        titleCanvas: "üé® Canvas",
        titleLayers: "üìö Layers",
        titleProcess: "‚öôÔ∏è Processing Settings",
        titleElements: "üî≤ Graphic Elements",
        titleDistances: "üìè Distances Between Elements",
        titleJson: "üìÑ Raw JSON Data",
        
        // General info labels
        version: "Version",
        createdAt: "Created on",
        modifiedAt: "Modified on",
        canvasId: "Canvas ID",
        projectId: "Project ID",
        elementsCount: "Elements count",
        layersCount: "Layers count",
        
        // Device
        deviceType: "Device type",
        laserPower: "Laser power",
        accessories: "Accessories",
        
        // Canvas
        canvasWidth: "Width",
        canvasHeight: "Height",
        gridVisible: "Grid visible",
        rulerVisible: "Ruler visible",
        
        // Layers
        layerVisible: "Visible",
        layerHidden: "Hidden",
        layerLocked: "Locked",
        layerUnlocked: "Unlocked",
        
        // Elements
        elementSize: "Size",
        elementPosition: "Position",
        elementRotation: "Rotation",
        elementVisible: "Visible",
        elementHidden: "Hidden",
        closedPath: "Closed path",
        openPath: "Open path",
        filled: "Filled",
        notFilled: "Not filled",
        strokeWidth: "Stroke",
        noPreview: "No preview",
        
        // Process
        processParams: "Processing settings",
        globalParams: "Global settings",
        elementParams: "Element settings",
        power: "Power",
        speed: "Speed",
        passes: "Passes",
        dpi: "DPI",
        density: "Density",
        frequency: "Frequency",
        laserSource: "Laser",
        slices: "Slices",
        angle: "Angle",
        ignored: "Ignored",
        viewElement: "View element",
        viewDetails: "Details",
        defaultParams: "Default parameters",
        noProcessAssociated: "No processing associated",
        
        // Process types
        processRelief: "üèîÔ∏è 3D Relief",
        processBitmapEngraving: "üñºÔ∏è Bitmap Engraving",
        processVectorEngraving: "‚úèÔ∏è Vector Engraving",
        processVectorCutting: "‚úÇÔ∏è Cutting",
        processScore: "üìè Score",
        
        // Distances
        distancesInfo: "Distances calculated between element centers (in mm)",
        filterSameLayer: "Show only elements from the same layer",
        sortBy: "Sort by:",
        sortDistanceAsc: "Distance (ascending)",
        sortDistanceDesc: "Distance (descending)",
        sortName: "Name",
        element1: "Element 1",
        element2: "Element 2",
        distance: "Distance",
        noPairFound: "No pair found",
        totalPairs: "Total:",
        pairs: "element pairs",
        needTwoElements: "At least 2 elements are needed to calculate distances",
        
        // JSON
        copyJson: "üìã Copy JSON",
        downloadJson: "üíæ Download",
        jsonCopied: "JSON copied to clipboard!",
        
        // General
        noData: "No data available",
        noPreviewAvailable: "No preview available",
        noElementAvailable: "No element available",
        noCanvasAvailable: "No canvas available",
        noLayerAvailable: "No layer available",
        noProcessAvailable: "No processing settings available",
        unrecognizedFormat: "Unrecognized data format",
        
        // Footer
        footer: "XCS Reader - xTool Creative Space File Reader (.xcs)",
        
        // Language
        language: "Language"
    }
};

// Current language
let currentLang = localStorage.getItem('xcsreader-lang') || 'en';

/**
 * Get translation for a key
 */
function t(key) {
    return translations[currentLang]?.[key] || translations['fr'][key] || key;
}

/**
 * Set language and save to localStorage
 */
function setLanguage(lang) {
    if (translations[lang]) {
        currentLang = lang;
        localStorage.setItem('xcsreader-lang', lang);
        updateUILanguage();
    }
}

/**
 * Update all UI elements with current language
 */
function updateUILanguage() {
    // Update HTML lang attribute
    document.documentElement.lang = currentLang;
    
    // Update page title
    document.title = currentLang === 'fr' ? 'XCS Reader - Lecteur de fichiers xTool' : 'XCS Reader - xTool File Reader';
    
    // Update static elements with data-i18n attribute
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (el.tagName === 'INPUT' && el.type === 'text') {
            el.placeholder = t(key);
        } else {
            el.innerHTML = t(key);
        }
    });
    
    // Update select options
    const distanceSort = document.getElementById('distanceSort');
    if (distanceSort) {
        distanceSort.innerHTML = `
            <option value="distance">${t('sortDistanceAsc')}</option>
            <option value="distance-desc">${t('sortDistanceDesc')}</option>
            <option value="name">${t('sortName')}</option>
        `;
    }
    
    // Update language selector
    const langSelect = document.getElementById('langSelect');
    if (langSelect) {
        langSelect.value = currentLang;
    }
    
    // Re-render dynamic content if data is loaded
    if (window.currentXCSData) {
        displayXCSData(window.currentXCSData);
    }
}

/**
 * Initialize language on page load
 */
function initLanguage() {
    currentLang = localStorage.getItem('xcsreader-lang') || 'fr';
    updateUILanguage();
}
